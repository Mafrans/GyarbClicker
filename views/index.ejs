<html>
    <head>
        <title></title>
        <link rel="stylesheet" href="/stylesheets/style.css" />
        <link rel="stylesheet" href="https://pagecdn.io/lib/uikit/3.5.5/css/uikit.min.css" />
    </head>

    <body>
        <div id="app">
            <div class="uk-height-1-1" uk-grid="">
                <div class="uk-width-1-3 uk-flex uk-flex-center uk-flex-column">
                    <div class="uk-margin-medium-left">
                        <h3> Total money / sec: $<span v-text="mps"></span> </h3>

                        <div v-for="worker in workers" @click="buyWorker(worker)">
                            <worker :name="worker.name" :cost="worker.cost" :speed="worker.speed" />
                        </div>
                    </div>
                </div>
                <div class="uk-width-1-3 uk-flex uk-flex-middle uk-flex-center uk-flex-column">
                    <h1 class="uk-margin-medium-bottom" id="money">
                        $<span v-text="money == Math.round(money) ? money : money.toFixed(2)"></span>
                    </h1>
                    <button @click="money++" class="click-button uk-button uk-button-default">Click</button>
                </div>
                <div class="uk-width-1-3"></div>
            </div>
        </div>

        <!-- development version, includes helpful console warnings -->
        <script src="https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js"></script>

        <!-- production version, optimized for size and speed -->
        <!-- <script src="https://cdn.jsdelivr.net/npm/vue@2"></script> -->

        <script src="/javascripts/worker.js"></script>
        <script>
            var app = new Vue({
                el: '#app',
                data: {
                    mps: 0,
                    money: 0,
                    workers: [
                        {
                            name: "Lazy Worker",
                            cost: 10,
                            speed: 1,
                            amount: 0,
                        },
                        {
                            name: "Steam-powered Clicker",
                            cost: 200,
                            speed: 10,
                            amount: 0,
                        },
                        {
                            name: "Advanced Robo-clicker",
                            cost: 1200,
                            speed: 50,
                            amount: 0,
                        },
                        {
                            name: "Clickosaurus Rex",
                            cost: 10000,
                            speed: 100,
                            amount: 0,
                        },
                        {
                            name: "Cheat-Machine",
                            cost: 100000,
                            speed: 1000,
                            amount: 0,
                        },
                    ],
                    time: {
                        last: Date.now(),
                        delta: 0,
                    }
                },
                methods: {
                    buyWorker(worker) {
                        if(this.money < worker.cost) return;

                        this.mps += worker.speed;
                        this.money -= worker.cost;
                        worker.cost = Math.round(worker.cost * 1.5);
                        worker.amount++;
                    },
                    updateLoop() {
                        this.time.delta = Date.now() - this.time.last;
                        this.money = this.money + parseFloat(this.mps * this.time.delta/1000000);
                        requestAnimationFrame(this.updateLoop)
                    }
                },
                mounted() {
                    this.updateLoop();
                }
            })
        </script>

        <script src="https://pagecdn.io/lib/uikit/3.5.5/js/uikit.min.js"></script>
        <script src="https://pagecdn.io/lib/uikit/3.5.5/js/uikit-icons.min.js"></script>
    </body>
</html>
